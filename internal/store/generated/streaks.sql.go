// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: streaks.sql

package generated

import (
	"context"
	"time"
)

const addStreak = `-- name: AddStreak :one
INSERT INTO streaks (habit_id, streak_start, streak_end)
VALUES (?, ?, ?)
RETURNING id
`

type AddStreakParams struct {
	HabitID     int64
	StreakStart time.Time
	StreakEnd   time.Time
}

func (q *Queries) AddStreak(ctx context.Context, arg AddStreakParams) (int64, error) {
	row := q.db.QueryRowContext(ctx, addStreak, arg.HabitID, arg.StreakStart, arg.StreakEnd)
	var id int64
	err := row.Scan(&id)
	return id, err
}

const deleteAllStreaksForHabit = `-- name: DeleteAllStreaksForHabit :exec
DELETE FROM streaks
WHERE habit_id = ?
`

func (q *Queries) DeleteAllStreaksForHabit(ctx context.Context, habitID int64) error {
	_, err := q.db.ExecContext(ctx, deleteAllStreaksForHabit, habitID)
	return err
}

const deleteStreakByID = `-- name: DeleteStreakByID :exec
DELETE FROM streaks
WHERE id = ?
`

func (q *Queries) DeleteStreakByID(ctx context.Context, id int64) error {
	_, err := q.db.ExecContext(ctx, deleteStreakByID, id)
	return err
}

const getLastCleanDay = `-- name: GetLastCleanDay :one
SELECT DATE(streak_end, '-1 day') as last_clean_day
FROM streaks
WHERE habit_id = ? AND
DATE(streak_end) <> DATE(streak_start)
ORDER BY streak_end DESC
LIMIT 1
`

func (q *Queries) GetLastCleanDay(ctx context.Context, habitID int64) (interface{}, error) {
	row := q.db.QueryRowContext(ctx, getLastCleanDay, habitID)
	var last_clean_day interface{}
	err := row.Scan(&last_clean_day)
	return last_clean_day, err
}

const getLatestStreak = `-- name: GetLatestStreak :one
SELECT id, habit_id, streak_start, streak_end
FROM streaks
ORDER BY streak_end DESC
LIMIT 1
`

func (q *Queries) GetLatestStreak(ctx context.Context) (Streak, error) {
	row := q.db.QueryRowContext(ctx, getLatestStreak)
	var i Streak
	err := row.Scan(
		&i.ID,
		&i.HabitID,
		&i.StreakStart,
		&i.StreakEnd,
	)
	return i, err
}

const getLatestStreakForHabit = `-- name: GetLatestStreakForHabit :one
SELECT id, habit_id, streak_start, streak_end
FROM streaks
WHERE habit_id = ?
ORDER BY streak_end DESC
LIMIT 1
`

func (q *Queries) GetLatestStreakForHabit(ctx context.Context, habitID int64) (Streak, error) {
	row := q.db.QueryRowContext(ctx, getLatestStreakForHabit, habitID)
	var i Streak
	err := row.Scan(
		&i.ID,
		&i.HabitID,
		&i.StreakStart,
		&i.StreakEnd,
	)
	return i, err
}

const getMaxStreak = `-- name: GetMaxStreak :one
SELECT CAST(COALESCE(MAX(julianday(streak_end) - julianday(streak_start) + 1), 0) AS INTEGER) as max_streak_days
FROM streaks
`

func (q *Queries) GetMaxStreak(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, getMaxStreak)
	var max_streak_days int64
	err := row.Scan(&max_streak_days)
	return max_streak_days, err
}

const getMaxStreakForHabit = `-- name: GetMaxStreakForHabit :one
SELECT CAST(COALESCE(MAX(julianday(streak_end) - julianday(streak_start) + 1), 0) AS INTEGER) as max_streak_days
FROM streaks
WHERE habit_id = ?
`

func (q *Queries) GetMaxStreakForHabit(ctx context.Context, habitID int64) (int64, error) {
	row := q.db.QueryRowContext(ctx, getMaxStreakForHabit, habitID)
	var max_streak_days int64
	err := row.Scan(&max_streak_days)
	return max_streak_days, err
}

const getMaxStreakQuittingHabit = `-- name: GetMaxStreakQuittingHabit :one
SELECT CAST(COALESCE(MAX(julianday(streak_end) - julianday(streak_start)), 0) AS INTEGER) as max_streak_days
FROM streaks
WHERE habit_id = ?
`

func (q *Queries) GetMaxStreakQuittingHabit(ctx context.Context, habitID int64) (int64, error) {
	row := q.db.QueryRowContext(ctx, getMaxStreakQuittingHabit, habitID)
	var max_streak_days int64
	err := row.Scan(&max_streak_days)
	return max_streak_days, err
}

const getStreaksInRange = `-- name: GetStreaksInRange :many
SELECT streak_start, streak_end
FROM streaks
WHERE streak_end >= ? AND streak_start <= ? AND
habit_id = ?
ORDER BY streak_start
`

type GetStreaksInRangeParams struct {
	StreakEnd   time.Time
	StreakStart time.Time
	HabitID     int64
}

type GetStreaksInRangeRow struct {
	StreakStart time.Time
	StreakEnd   time.Time
}

func (q *Queries) GetStreaksInRange(ctx context.Context, arg GetStreaksInRangeParams) ([]GetStreaksInRangeRow, error) {
	rows, err := q.db.QueryContext(ctx, getStreaksInRange, arg.StreakEnd, arg.StreakStart, arg.HabitID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetStreaksInRangeRow
	for rows.Next() {
		var i GetStreaksInRangeRow
		if err := rows.Scan(&i.StreakStart, &i.StreakEnd); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getTotalStreakDays = `-- name: GetTotalStreakDays :one
SELECT CAST(COALESCE(SUM(julianday(streak_end) - julianday(streak_start) + 1), 0) AS INTEGER) as total_streak_days
FROM streaks 
WHERE habit_id = ?
`

func (q *Queries) GetTotalStreakDays(ctx context.Context, habitID int64) (int64, error) {
	row := q.db.QueryRowContext(ctx, getTotalStreakDays, habitID)
	var total_streak_days int64
	err := row.Scan(&total_streak_days)
	return total_streak_days, err
}

const getTotalStreakDaysQuittingHabit = `-- name: GetTotalStreakDaysQuittingHabit :one
SELECT CAST(COALESCE(SUM(julianday(streak_end) - julianday(streak_start)), 0) AS INTEGER) as total_streak_days
FROM streaks 
WHERE habit_id = ?
`

func (q *Queries) GetTotalStreakDaysQuittingHabit(ctx context.Context, habitID int64) (int64, error) {
	row := q.db.QueryRowContext(ctx, getTotalStreakDaysQuittingHabit, habitID)
	var total_streak_days int64
	err := row.Scan(&total_streak_days)
	return total_streak_days, err
}

const updateStreakEnd = `-- name: UpdateStreakEnd :exec
UPDATE streaks
SET streak_end = ?
WHERE id = ?
`

type UpdateStreakEndParams struct {
	StreakEnd time.Time
	ID        int64
}

func (q *Queries) UpdateStreakEnd(ctx context.Context, arg UpdateStreakEndParams) error {
	_, err := q.db.ExecContext(ctx, updateStreakEnd, arg.StreakEnd, arg.ID)
	return err
}
